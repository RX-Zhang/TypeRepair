--- 
+++ 
@@ -1,8 +1,19 @@
 public static double distance(int[] p1, int[] p2) {
-  int sum = 0;
+  if (p1 == null || p2 == null) {
+    throw new IllegalArgumentException("Input point arrays must not be null.");
+  }
+  if (p1.length != p2.length) {
+    throw new IllegalArgumentException("Input point arrays must have the same length.");
+  }
+  long sum = 0;
   for (int i = 0; i < p1.length; i++) {
-      final int dp = p1[i] - p2[i];
+      long dp = (long) p1[i] - (long) p2[i];
       sum += dp * dp;
+      if (sum < 0) {
+          // overflow detected
+          throw new ArithmeticException("Integer overflow while computing squared distance.");
+      }
   }
   return Math.sqrt(sum);
 }
+
