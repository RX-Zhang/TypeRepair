--- 
+++ 
@@ -2,9 +2,13 @@
     if (width > 0) {
         ensureCapacity(size + width);
         String str = (obj == null ? getNullText() : obj.toString());
+        if (str == null) {
+            str = "";
+        }
         int strLen = str.length();
         if (strLen >= width) {
-            str.getChars(0, strLen, buffer, size);
+            // Copy only width chars to avoid ArrayIndexOutOfBoundsException
+            str.getChars(0, width, buffer, size);
         } else {
             int padLen = width - strLen;
             str.getChars(0, strLen, buffer, size);
@@ -16,3 +20,4 @@
     }
     return this;
 }
+
