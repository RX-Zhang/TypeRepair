--- 
+++ 
@@ -49,10 +49,14 @@
         // Add it after the parent namespace.
         ProvidedName parentName =
             providedNames.get(namespace.substring(0, indexOfDot));
-        Preconditions.checkNotNull(parentName);
-        Preconditions.checkNotNull(parentName.replacementNode);
-        parentName.replacementNode.getParent().addChildAfter(
-            replacementNode, parentName.replacementNode);
+        if (parentName != null && parentName.replacementNode != null) {
+          parentName.replacementNode.getParent().addChildAfter(
+              replacementNode, parentName.replacementNode);
+        } else {
+          // Handle the case where the parentName is not found
+          // or doesn't have a replacementNode.
+          compiler.report(t.makeError(n, MISSING_PROVIDE_ERROR, namespace));
+        }
       }
     }
     if (explicitNode != null) {
@@ -61,3 +65,4 @@
     compiler.reportCodeChange();
   }
 }
+
