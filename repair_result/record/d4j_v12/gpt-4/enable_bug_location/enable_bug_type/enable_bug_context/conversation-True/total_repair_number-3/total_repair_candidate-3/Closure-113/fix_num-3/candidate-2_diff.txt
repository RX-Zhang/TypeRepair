--- 
+++ 
@@ -33,8 +33,10 @@
     // allow broken requires to be preserved by the first run to
     // let them be caught in the subsequent run.
     if (provided != null) {
-      parent.detachFromParent();
+      // Detach the entire require call node (n), not just the left child.
+      n.detachFromParent();
       compiler.reportCodeChange();
     }
   }
 }
+
