--- 
+++ 
@@ -6,7 +6,16 @@
     }
     Class<?>[] classes = new Class[array.length];
     for (int i = 0; i < array.length; i++) {
-        classes[i] = array[i].getClass();
+        Object element = array[i];
+        if (element == null) {
+            classes[i] = null;
+        } else {
+            classes[i] = wrapperToPrimitive(element.getClass());
+            if (classes[i] == null) {
+                classes[i] = element.getClass();
+            }
+        }
     }
     return classes;
 }
+
