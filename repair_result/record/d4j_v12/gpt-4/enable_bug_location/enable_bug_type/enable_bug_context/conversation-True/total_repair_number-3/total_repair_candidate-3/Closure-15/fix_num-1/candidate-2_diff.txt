--- 
+++ 
@@ -18,9 +18,15 @@
 
 
   for (Node c = n.getFirstChild(); c != null; c = c.getNext()) {
-    if (!ControlFlowGraph.isEnteringNewCfgNode(c) && apply(c)) {
-      return true;
+    // Fix: If we are entering a new CFG node, skip recursion into that node,
+    // but ONLY if the current node is NOT itself a new CFG node.
+    // This prevents reordering side-effecting expressions like "a in b"
+    if (!ControlFlowGraph.isEnteringNewCfgNode(c) || ControlFlowGraph.isEnteringNewCfgNode(n)) {
+      if (apply(c)) {
+        return true;
+      }
     }
   }
   return false;
 }
+
