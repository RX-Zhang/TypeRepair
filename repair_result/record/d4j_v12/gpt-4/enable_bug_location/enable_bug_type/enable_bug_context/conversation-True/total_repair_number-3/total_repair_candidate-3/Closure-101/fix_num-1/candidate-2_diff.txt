--- 
+++ 
@@ -1,21 +1,30 @@
 protected CompilerOptions createOptions() {
   CompilerOptions options = new CompilerOptions();
-  options.setCodingConvention(new ClosureCodingConvention());
+  CompilerOptions baseOptions = new CompilerOptions();
   CompilationLevel level = flags.compilation_level;
-  level.setOptionsForCompilationLevel(options);
+  level.setOptionsForCompilationLevel(baseOptions);
   if (flags.debug) {
-    level.setDebugOptionsForCompilationLevel(options);
+    level.setDebugOptionsForCompilationLevel(baseOptions);
   }
 
   WarningLevel wLevel = flags.warning_level;
-  wLevel.setOptionsForWarningLevel(options);
+  wLevel.setOptionsForWarningLevel(baseOptions);
+
   for (FormattingOption formattingOption : flags.formatting) {
-    formattingOption.applyToOptions(options);
-  }
-  if (flags.process_closure_primitives) {
-    options.closurePass = true;
+    formattingOption.applyToOptions(baseOptions);
   }
 
+  if (flags.process_closure_primitives) {
+    baseOptions.closurePass = true;
+  } else {
+    options.closurePass = false;
+  }
+
+  // Copy all fields from baseOptions to options to ensure correct settings
+  options = baseOptions;
+
   initOptionsFromFlags(options);
+
   return options;
 }
+
