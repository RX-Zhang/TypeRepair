--- 
+++ 
@@ -40,7 +40,8 @@
       }
     }
   } else if (parent.getType() != Token.EXPR_RESULT && parent.getType() != Token.BLOCK) {
-    if (! (parent.getType() == Token.FOR && parent.getChildCount() == 4 && (n == parent.getFirstChild() || n == parent.getFirstChild().getNext().getNext()))) {
+    if (!(parent.getType() == Token.FOR && parent.getChildCount() == 4 &&
+          (n == parent.getFirstChild() || n == parent.getFirstChild().getNext().getNext()))) {
       return;
     }
   }
@@ -56,10 +57,12 @@
 
     t.getCompiler().report(
         t.makeError(n, level, USELESS_CODE_ERROR, msg));
-    // TODO(johnlenz): determine if it is necessary to
-    // try to protect side-effect free statements as well.
+    // Protect side-effect-free expressions by wrapping them in a preservative call
     if (!NodeUtil.isStatement(n)) {
-      problemNodes.add(n);
+      if (protectSideEffectFreeCode) {
+        problemNodes.add(n);
+      }
     }
   }
 }
+
