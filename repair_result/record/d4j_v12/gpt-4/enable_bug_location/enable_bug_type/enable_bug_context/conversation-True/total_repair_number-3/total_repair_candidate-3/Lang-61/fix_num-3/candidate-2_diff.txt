--- 
+++ 
@@ -4,17 +4,17 @@
         return -1;
     }
     int strLen = str.length();
+    if (strLen == 0) {
+        return startIndex;
+    }
     if (strLen == 1) {
         return indexOf(str.charAt(0), startIndex);
-    }
-    if (strLen == 0) {
-        return startIndex;
     }
     if (strLen > size) {
         return -1;
     }
     char[] thisBuf = buffer;
-    int len = thisBuf.length - strLen;
+    int len = size - strLen + 1;
     outer:
     for (int i = startIndex; i < len; i++) {
         for (int j = 0; j < strLen; j++) {
@@ -26,3 +26,4 @@
     }
     return -1;
 }
+
