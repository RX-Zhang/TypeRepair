--- 
+++ 
@@ -77,6 +77,7 @@
                         } else {
                             d = -tol1;
                         }
+                        u = x + d;
                     }
                 } else {
                     // Golden section step.
@@ -161,3 +162,4 @@
         ++iter;
     }
 }
+
