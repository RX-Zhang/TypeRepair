--- 
+++ 
@@ -2,7 +2,7 @@
     throws NonPositiveDefiniteMatrixException {
 
     final int order = matrix.getRowDimension();
-    final double[][] c = matrix.getData();
+    final double[][] c = matrix.copy().getData();
     final double[][] b = new double[order][order];
 
     int[] swap  = new int[order];
@@ -18,12 +18,11 @@
         swap[r] = r;
         for (int i = r + 1; i < order; ++i) {
             int ii  = index[i];
-            int isi = index[swap[i]];
+            int isi = index[swap[r]];
             if (c[ii][ii] > c[isi][isi]) {
                 swap[r] = i;
             }
         }
-
 
         // swap elements
         if (swap[r] != r) {
@@ -51,7 +50,6 @@
 
             // all remaining diagonal elements are close to zero, we consider we have
             // found the rank of the symmetric positive semidefinite matrix
-            ++r;
             loop = false;
 
         } else {
@@ -88,3 +86,4 @@
     }
 
 }
+
