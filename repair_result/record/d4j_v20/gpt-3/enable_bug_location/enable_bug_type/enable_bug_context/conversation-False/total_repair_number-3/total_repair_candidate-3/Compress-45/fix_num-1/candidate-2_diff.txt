--- 
+++ 
@@ -9,11 +9,18 @@
         return formatLongOctalBytes(value, buf, offset, length);
     }
 
+    // Exception handling for length check
+    if (length <= 0) {
+        throw new IllegalArgumentException("Length must be greater than 0");
+    }
+
     if (length < 9) {
         formatLongBinary(value, buf, offset, length, negative);
+    } else {
+        formatBigIntegerBinary(value, buf, offset, length, negative);
     }
-    formatBigIntegerBinary(value, buf, offset, length, negative);
 
     buf[offset] = (byte) (negative ? 0xff : 0x80);
     return offset + length;
 }
+
