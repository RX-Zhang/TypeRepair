--- 
+++ 
@@ -40,6 +40,7 @@
             else if (options.hasOption(token))
             {
                 tokens.add(token);
+                currentOption = options.getOption(token); // Ensure currentOption is set
             }
             // requires bursting
             else
@@ -59,5 +60,11 @@
         gobble(iter);
     }
 
+    // Ensure to add remaining tokens if eatTheRest is true
+    if (eatTheRest) {
+        tokens.addAll(Arrays.asList(arguments).subList(tokens.size(), arguments.length));
+    }
+
     return (String[]) tokens.toArray(new String[tokens.size()]);
 }
+
