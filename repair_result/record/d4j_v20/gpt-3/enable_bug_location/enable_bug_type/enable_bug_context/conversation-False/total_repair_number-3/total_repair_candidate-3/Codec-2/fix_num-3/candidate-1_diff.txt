--- 
+++ 
@@ -29,8 +29,12 @@
                     buf[pos++] = PAD;
                 }
                 break;
+
+            case 0:
+                // No leftover bytes; no padding needed.
+                break;
         }
-        if (lineLength > 0) {
+        if (lineLength > 0 && pos > 0) {
             System.arraycopy(lineSeparator, 0, buf, pos, lineSeparator.length);
             pos += lineSeparator.length;
         }
@@ -58,3 +62,4 @@
         }
     }
 }
+
