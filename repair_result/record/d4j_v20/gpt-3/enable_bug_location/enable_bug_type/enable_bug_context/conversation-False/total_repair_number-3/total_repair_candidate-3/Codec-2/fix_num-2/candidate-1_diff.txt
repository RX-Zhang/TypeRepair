--- 
+++ 
@@ -29,8 +29,11 @@
                     buf[pos++] = PAD;
                 }
                 break;
+            case 0:
+                // No partial bytes to encode, so do nothing here.
+                break;
         }
-        if (lineLength > 0) {
+        if (lineLength > 0 && pos > 0) {
             System.arraycopy(lineSeparator, 0, buf, pos, lineSeparator.length);
             pos += lineSeparator.length;
         }
@@ -43,7 +46,7 @@
             int b = in[inPos++];
             if (b < 0) { b += 256; }
             x = (x << 8) + b;
-            if (0 == modulus) {
+            if (modulus == 0) {
                 buf[pos++] = encodeTable[(x >> 18) & MASK_6BITS];
                 buf[pos++] = encodeTable[(x >> 12) & MASK_6BITS];
                 buf[pos++] = encodeTable[(x >> 6) & MASK_6BITS];
@@ -58,3 +61,4 @@
         }
     }
 }
+
