--- 
+++ 
@@ -6,8 +6,11 @@
         _hashShared = false;
         // 09-Sep-2015, tatu: As per [jackson-core#216], also need to ensure
         //    we rehash as needed, as need-rehash flag is not copied from parent
+        if (_needRehash) {
+            rehash();
+        }
     }
-    if (_needRehash) {
-        rehash();
-    }
+    // Previously, rehash() call was outside of if(_hashShared),
+    // leading to possible rehash attempts on unshared tables, causing index OOB exceptions.
 }
+
