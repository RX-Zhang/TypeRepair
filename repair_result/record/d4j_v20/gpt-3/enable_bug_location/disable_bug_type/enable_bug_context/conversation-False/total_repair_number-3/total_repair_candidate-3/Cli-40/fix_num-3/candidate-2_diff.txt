--- 
+++ 
@@ -26,7 +26,7 @@
     }
     else if (PatternOptionBuilder.EXISTING_FILE_VALUE == clazz)
     {
-        return (T) openFile(str);
+        return (T) createFile(str);  // Changed from openFile to createFile
     }
     else if (PatternOptionBuilder.FILES_VALUE == clazz)
     {
@@ -38,6 +38,7 @@
     }
     else
     {
-        return null;
+        throw new ParseException("Cannot convert '" + str + "' to class " + clazz.getName());
     }
 }
+
