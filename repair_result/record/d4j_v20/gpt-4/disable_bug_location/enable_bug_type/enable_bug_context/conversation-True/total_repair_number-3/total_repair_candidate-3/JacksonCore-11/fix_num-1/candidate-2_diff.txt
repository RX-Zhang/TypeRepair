--- 
+++ 
@@ -8,6 +8,13 @@
         //    we rehash as needed, as need-rehash flag is not copied from parent
     }
     if (_needRehash) {
-        rehash();
+        // Add boundary check to avoid ArrayIndexOutOfBoundsException during rehash
+        if (_hashArea != null && _hashArea.length > 0) {
+            rehash();
+        } else {
+            // If hashArea is null or empty, set _needRehash to false to avoid rehash attempts
+            _needRehash = false;
+        }
     }
 }
+
