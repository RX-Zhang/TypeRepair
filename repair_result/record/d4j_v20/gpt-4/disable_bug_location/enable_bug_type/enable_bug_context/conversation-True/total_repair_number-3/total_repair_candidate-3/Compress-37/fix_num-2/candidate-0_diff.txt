--- 
+++ 
@@ -6,6 +6,7 @@
         int ch;
         int len = 0;
         int read = 0;
+        // Read length prefix
         while((ch = i.read()) != -1) {
             read++;
             if (ch == ' '){
@@ -20,6 +21,9 @@
                         if (restLen == 1) { // only NL
                             headers.remove(keyword);
                         } else {
+                            if (restLen < 0) {
+                                throw new IOException("Invalid pax header length: " + len);
+                            }
                             final byte[] rest = new byte[restLen];
                             final int got = IOUtils.readFully(i, rest);
                             if (got != restLen) {
@@ -40,6 +44,10 @@
                 }
                 break; // Processed single header
             }
+            // Validate that ch is a digit before processing
+            if (ch < '0' || ch > '9') {
+                throw new IOException("Invalid pax header length character: " + (char) ch);
+            }
             len *= 10;
             len += ch - '0';
         }
@@ -49,3 +57,4 @@
     }
     return headers;
 }
+
