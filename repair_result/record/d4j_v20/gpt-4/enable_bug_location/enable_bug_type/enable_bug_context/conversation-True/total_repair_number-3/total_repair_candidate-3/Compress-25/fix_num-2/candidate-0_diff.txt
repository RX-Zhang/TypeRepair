--- 
+++ 
@@ -4,8 +4,10 @@
                              boolean allowStoredEntriesWithDataDescriptor) {
     zipEncoding = ZipEncodingHelper.getZipEncoding(encoding);
     this.useUnicodeExtraFields = useUnicodeExtraFields;
-    in = new PushbackInputStream(inputStream, buf.capacity());
+    // Fixed the PushbackInputStream buffer size by using ZipArchiveOutputStream.BUFFER_SIZE instead of buf.capacity()
+    in = new PushbackInputStream(inputStream, ZipArchiveOutputStream.BUFFER_SIZE);
     this.allowStoredEntriesWithDataDescriptor =
         allowStoredEntriesWithDataDescriptor;
     // haven't read anything so far
 }
+
